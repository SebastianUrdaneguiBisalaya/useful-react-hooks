import CodeBlock from "@/components/shared/Codeblock";
import Demo from "@/app/docs/connectivity-and-async/useAsyncState/Demo";
import Table from "@/components/shared/Table";
import data from "@/app/docs/connectivity-and-async/useAsyncState/data.json";

# useAsyncState

### A robust React hook for managing asynchronous operations and remote data fetching with integrated state tracking and retry logic.

#### Installation

<CodeBlock
  code={`npm install @vibehooks/react/useAsyncState`}
  language="bash"
/>

#### Description

The **useAsyncState** hook provides a full-featured lifecycle management system for asynchronous requests. It eliminates the boilerplate of manually handling **loading**, **error**, and **data** states, while offering advanced features like automatic retries, request timeouts, URL parameter serialization, optimistic updates via **mutate**, and request cancellation via **AbortController**.

#### Parameters

<Table data={data.parameters} />

#### Return values

<Table data={data.returnValues} />

#### Demo

<Demo />


#### Source code

```tsx
'use client';

import { useState } from "react";
import { useAsyncState } from "../../../../../../src";
import LayoutDemo from "@/layouts/LayoutDemo";

export interface Post {
  id: number;
  title: string;
}

export default function Demo() {
  const [searchQuery, setSearchQuery] = useState<string>('');
  const {
    data,
    isLoading,
    isError,
    error,
    execute,
    retry,
    reset
  } = useAsyncState<Post[]>();

  const handleFetch = () => {
    execute('https://jsonplaceholder.typicode.com/posts', {
      params: {
        _limit: 5,
        q: searchQuery,
        retries: 2,
      }
    });
  }
  return (
    <LayoutDemo
      title="Async State"
    >
      <div className="w-full grid grid-cols-2 md:flex gap-2">
        <input
          className="max-md:col-span-full flex-1 w-full px-4 py-3 font-reddit-sans border border-white/40 rounded-lg focus:outline-none"
          placeholder="Search posts..."
          value={searchQuery}
          onChange={(e) => setSearchQuery(e.target.value)}
        />
        <button
          onClick={handleFetch}
          disabled={isLoading}
          className="px-6 py-2 bg-purple-500 font-reddit-sans cursor-pointer hover:bg-purple-600 transition-colors duration-500 ease-in-out text-white rounded-md font-semibold disabled:bg-blue-300 disabled:text-black"
        >
          {isLoading ? 'Loading...' : 'Search'}
        </button>
        <button onClick={reset} className="px-4 py-3 font-reddit-sans cursor-pointer border border-white/30 rounded-md text-white/60 hover:text-white/70 transition-colors duration-500 ease-in-out">
          Reset
        </button>
      </div>

      <div className="space-y-4">
        {isError && (
          <div className="p-4 bg-red-50 border border-red-200 rounded-xl">
            <p className="text-red-700 font-medium font-reddit-sans">Error: {error?.message}</p>
            <button
              onClick={() => retry()}
              className="mt-2 text-sm font-bold font-reddit-sans text-red-800 underline"
            >
              Try Again
            </button>
          </div>
        )}

        {isLoading && (
          <div className="flex items-center justify-center p-12">
            <div className="w-8 h-8 font-reddit-sans border-4 border-blue-600 border-t-transparent rounded-full animate-spin" />
          </div>
        )}

        {data && (
          <ul className="divide-y divide-white/40 overflow-hidden">
            {data.map(post => (
              <li key={post.id} className="px-4 py-2 bg-neutral-900 hover:bg-neutral-700 transition-colors duration-500 ease-in-out">
                <h4 className="font-medium text-sm text-white/80 capitalize">{post.title}</h4>
                <p className="text-xs text-white/50 font-reddit-sans">ID: {post.id}</p>
              </li>
            ))}
          </ul>
        )}

        <div className="text-center">
          <p className="text-xs font-reddit-sans text-white/40">
            Enter a query and click &quot;Fetch Posts&quot; to see results.
          </p>
        </div>
      </div>
    </LayoutDemo>
  )
}
```
