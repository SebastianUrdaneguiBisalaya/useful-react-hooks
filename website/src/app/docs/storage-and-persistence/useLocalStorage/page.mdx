import { CodeBlock } from "@/components/shared/Codeblock";
import Demo from "@/app/docs/storage-and-persistence/useLocalStorage/Demo";
import Table from "@/components/shared/Table";
import data from "@/app/docs/storage-and-persistence/useLocalStorage/data.json";

# **useLocalStorage**

### A typed React hook for interacting with the Web Storage API, providing automatic JSON serialization and fallback support.

#### **Installation**

<CodeBlock
  code={`npm install @vibehooks/react/useLocalStorage`}
  language="bash"
/>

#### **Description**

The **useLocalStorage** provides a clean, typed API for **window.localStorage**. It automatically handles the conversion between JavaScript objects and JSON strings, preventing common parsing errors. It includes a fallback mechanism for missing keys and a functional **update** method that allows for state-like modifications to the stored value. The hook is SSR-safe and performs runtime environment checks before execution.

#### **Parameters**

<Table data={data.parameters} />

#### **Return values**

<Table data={data.returnValues} />

#### **Demo**

<Demo />

#### **Source code**

```tsx
'use client';

import { useState, useEffect } from "react";
import { useLocalStorage } from "@vibehooks/react/useLocalStorage";
import LayoutDemo from "@/layouts/LayoutDemo";
import LayoutNotMounted from "@/layouts/LayoutNotMounted";
import { Button } from "@/components/ui/Button";
import { cn } from "@/lib/cn";

export interface Preferences {
  compactMode: boolean;
}

export default function Demo() {
  const [isMounted, setIsMounted] = useState<boolean>(false);
  const storage = useLocalStorage<Preferences>('preferences', {
    fallback: {
      compactMode: false,
    }
  });

  const prefs = storage.value;

  const handleToggle = () => {
    storage.update(prev => ({
      ...prev,
      compactMode: !prev!.compactMode,
    }))
  }

  useEffect(() => {
    setTimeout(() => {
      setIsMounted(true);
    }, 100);
  }, []);

  if (!isMounted) return <LayoutNotMounted />;
  if (!prefs) return null;

  return (
    <LayoutDemo
      title="Local Storage"
    >
      <div className="w-full flex flex-row items-center gap-4 justify-center">
        <span className="font-reddit-sans text-sm text-white/70">
          Compact mode
        </span>
        <Button.Secondary
          className="rounded-full"
          onClick={handleToggle}
        >
          <div
            className={cn(
              'h-5 w-5 bg-white-100 rounded-full transition-transform duration-500 ease-in-out',
              prefs.compactMode ? 'translate-x-3' : '-translate-x-3'
            )}
          />
        </Button.Secondary>
      </div>
    </LayoutDemo>
  )
}
```
