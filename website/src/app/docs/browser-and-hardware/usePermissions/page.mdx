import CodeBlock from "@/components/shared/Codeblock";
import Demo from "@/app/docs/browser-and-hardware/usePermissions/Demo";
import Table from "@/components/shared/Table";
import data from "@/app/docs/browser-and-hardware/usePermissions/data";

# usePermissions

### A reactive hook that observes and synchronizes browser permission statuses in real-time.

#### Installation

<CodeBlock
  code={`npm install @vibehooks/react/usePermissions`}
  language="bash"
/>

#### Description

The **usePermissions** hook provides a declarative way to monitor the status of various browser features (such as camera access, geolocation, or notifications). It abstracts the complexities of the Permissions API by handling the initial asynchronous query and subscribing to state changes automatically. This allows the UI to react instantly when the user modifies permissions via the browser's settings bar.

#### Parameters

<Table data={data.parameters} />

#### Return values

<Table data={data.returnValues} />

#### Demo

<Demo />

#### Source code

```tsx
'use client';

import { useState, useEffect } from "react";

import { usePermissions, type PermissionState } from "../../../../../../src/usePermissions";
import { Layout } from "@/layouts/Layout";
import { cn } from '@/lib/cn';

const PERMISSIONS_TO_TRACK: PermissionName[] = [
  'camera',
  'microphone',
  'geolocation',
  'notifications',
];

export default function Demo() {
  const { isSupported, permissions } = usePermissions(PERMISSIONS_TO_TRACK);
  const [isMounted, setIsMounted] = useState<boolean>(false);

  useEffect(() => {
    setTimeout(() => setIsMounted(true), 100);
  }, []);

  if (!isMounted) {
    return (
      <Layout>
        <Layout.ContentLoading />
      </Layout>
    )
  }

  if (!isSupported) {
    return (
      <Layout>
        <Layout.ContentNotSupported>
          The Permissions API is not supported in this browser.
        </Layout.ContentNotSupported>
      </Layout>
    )
  }

  return (
    <Layout>
      <Layout.Title>Browser Permissions Tracker</Layout.Title>
      {
        isSupported ? (
          <>
            <div className="space-y-3">
              {PERMISSIONS_TO_TRACK.map((name) => {
                const status = permissions[name];

                return (
                  <div className="flex gap-4 items-center justify-between p-2 border border-white/20 rounded-lg" key={name}>
                    <Layout.Paragraph className="capitalize">{name}</Layout.Paragraph>
                    <StatusBadge status={status} />
                  </div>
                );
              })}
            </div>

            <Layout.Caption>
              Try changing permissions in your browser settings to see the UI update automatically.
            </Layout.Caption>
          </>
        ) : (
          <Layout.Error>
            Error: The Permissions API is not supported in this browser.
          </Layout.Error>
        )
      }
    </Layout>
  )
}

function StatusBadge({ status }: { status?: PermissionState }) {
  const colors: Record<string, string> = {
    denied: 'bg-red-100 text-red-800',
    granted: 'bg-green-100 text-green-800',
    loading: 'bg-gray-100 text-gray-400',
    prompt: 'bg-yellow-100 text-yellow-800',
  };

  const currentStatus = status || 'loading';

  return (
    <span className={cn(
      'px-2 py-1 rounded text-xs font-reddit-sans font-medium capitalize',
      colors[currentStatus]
    )}>
      {currentStatus}
    </span>
  );
};
```

