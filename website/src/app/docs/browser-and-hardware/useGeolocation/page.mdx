import CodeBlock from "@/components/shared/Codeblock";
import Demo from "@/app/docs/browser-and-hardware/useGeolocation/Demo";
import Table from "@/components/shared/Table";
import data from "@/app/docs/browser-and-hardware/useGeolocation/data";

# **useGeolocation**

### A comprehensive, SSR-safe hook for interfacing with the Geolocation API and Permissions API to track device coordinates and access status.

#### **Installation**

<CodeBlock
  code={`npm install @vibehooks/react/useGeolocation`}
  language="bash"
/>

#### **Description**

The **useGeolocation** provides a structured interface for retrieving and monitoring the physical location of a device. It abstracts the imperative nature of the browser's **navigation.geolocation** into a declarative React state, handling support detection and permission lifecycle tracking automatically.

This hook is designed for applications requiring spatial awareness—such as maps, delivery services, or localized content—while maintaining a strict **unopinionated** approach by allowing the developer to decide exactly when to trigger tracking or single requests.

#### **Return values**

<Table data={data.returnValues} />

#### **Demo**

<Demo />

#### **Source code**

```tsx
'use client';

import { useState, useEffect } from 'react';
import { useGeolocation } from "@vibehooks/react/useGeolocation";

export default function Demo() {
  const { clearWatch, error, getCurrentPosition, isSupported, permissionState, position, watchPosition } = useGeolocation();

  const [watcherId, setWatcherId] = useState<number | null>(null);
  const [mounted, setMounted] = useState<boolean>(false);

  useEffect(() => {
    setTimeout(() => setMounted(true), 100);
  }, []);

  if (!mounted) {
    return (
      <div className="w-full border border-white/20 p-4 flex items-center justify-center">
        <span className="text-white/20 text-sm text-center">Loading geolocation info…</span>
      </div>
    );
  }

  const toggleTracking = () => {
    if (watcherId !== null) {
      clearWatch(watcherId);
      setWatcherId(null);
    } else {
      const id = watchPosition({ enableHighAccuracy: true });
      setWatcherId(id);
    }
  };
  return (
    <div className="w-full space-y-4 p-4 border border-white/20 rounded-lg shadow-md">
      <div className="flex gap-2 justify-between items-center">
        <h3 className="text-lg font-bold text-white/60 font-sora">Geolocation</h3>
        <span className={`px-2 py-1 rounded text-[10px] font-bold uppercase ${
          permissionState === 'granted' ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-500'
        }`}>
          {permissionState}
        </span>
      </div>

      {!isSupported ? (
        <p className="text-sm text-red-500 bg-red-50 p-3 rounded font-reddit-sans">Geolocation not supported.</p>
      ) : (
        <div className="space-y-4">
          <div className="grid grid-cols-2 gap-4">
            <div className="p-3 border border-white/20 rounded-md space-y-2">
              <p className="text-[10px] uppercase font-reddit-sans font-bold text-white/60">Latitude</p>
              <p className="text-sm font-reddit-sans">{position?.coords.latitude.toFixed(6) ?? '—'}</p>
            </div>
            <div className="p-3 border border-white/20 rounded-md space-y-2">
              <p className="text-[10px] uppercase font-reddit-sans font-bold text-white/60">Longitude</p>
              <p className="text-sm font-reddit-sans">{position?.coords.longitude.toFixed(6) ?? '—'}</p>
            </div>
          </div>

          {error && (
            <p className="text-xs text-red-500 bg-red-50 p-2 rounded font-reddit-sans">Error: {error.message}</p>
          )}

          <div className="flex gap-4">
            <button
              onClick={() => getCurrentPosition()}
              className="flex-1 cursor-pointer px-4 py-2 font-reddit-sans bg-purple-400 text-white rounded-lg text-sm font-medium hover:bg-purple-500 transition-colors duration-500 ease-in-out"
            >
              Get Once
            </button>
            <button
              onClick={toggleTracking}
              className={`flex-1 cursor-pointer px-4 py-2 font-reddit-sans rounded-lg text-sm font-medium border transition-colors duration-500 ease-in-out ${
                watcherId !== null ? 'bg-red-50 border-red-200 text-red-600' : 'bg-white border-slate-200 text-slate-700'
              }`}
            >
              {watcherId !== null ? 'Stop Tracking' : 'Start Watch'}
            </button>
          </div>
        </div>
      )}
    </div>
  )
}
```

